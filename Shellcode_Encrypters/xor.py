#!/usr/bin/python3
import sys

#key to use to encrypt our payload
KEY= "ZXSD"
def DoXor(data, key):
        
        key = str(key)
        l = len(key)
        output_str = ""

        for i in range(len(data)):
                current = data[i]
                current_key = key[i % len(key)]
                output_str += chr((current) ^ ord(current_key))
        
        return (output_str)
#read the shellcode from the file and then encrypt it
try:
    plaintext = open(sys.argv[1], "rb").read()
except:
    print("File argument needed! %s <raw payload file>" % sys.argv[0])
    sys.exit()

ciphertext = DoXor(plaintext, KEY)
#output the shellcode in a correct format of 0x
print('{ 0x' + ', 0x'.join(hex(ord(x))[2:] for x in ciphertext) + ' };')
